import os
import requests as re
from bs4 import BeautifulSoup
from PIL import Image
from io import BytesIO


class scrape:
    def __init__(self, term):
        self.search_term = term
        self.dir_name = self.search_term.replace(" ", "_").lower()
        if not os.path.isdir(self.dir_name):
            os.makedirs(self.dir_name)

    def getSearch(self):
        return self.search_term

    def getDir(self):
        return self.dir_name

    def image(self, url):
        param = {"q": self.getSearch()}
        try:
            ri = re.get(url)
            print(url)
            soupi = BeautifulSoup(ri.text, "html.parser")
            links = soupi.findAll("a", {"class": "thumb"})
            for item in links:
                try:
                    img_obj = re.get(item.attrs["href"])
                    title = item["href"].split("/")[-1]
                    try:
                        img = Image.open(BytesIO(img_obj.content))
                        img.save("./" + self.getDir() + "/" + title, img.format)
                    except Exception as e:
                        print(e)
                except Exception as e:
                    print(e)
        except Exception as e:
            print(e)